# Certbot automatic renewal configuration
# Certificates are renewed automatically and nginx is reloaded after renewal

files:
  "/etc/cron.d/certbot_renew":
    mode: "000644"
    owner: root
    group: root
    content: |
      # Certbot renewal cron job
      # Runs twice daily at 2:23 AM and 2:23 PM (Let's Encrypt recommendation)
      # Only renews certificates that are within 30 days of expiration
      23 2,14 * * * root /usr/bin/certbot renew --quiet --deploy-hook "systemctl reload nginx || true"

commands:
  01_remove_old_cron:
    command: "rm -f /etc/cron.d/certbot_renew.bak"
    ignoreErrors: true

